$(function(){
   // var socket = io.connect("http://localhost:82");
    var chatkey ="";
    var receiveId ="";
    var sendId = "";
    
});

function viewChat(dm_id,dm_key){
	var dmKey = dm_key;
	var receiveId = dm_id;
	var sendId = '<c:out value="user.user_id"/>';
	alert("text");
	$("#chatHeader").html(receiveId);
	$("#noWrap").css("display","none");
	$("#chatWrap").css("display","block");
	$("#chatLog").html("");
	
	$.ajax({
    	type:'POST',
		url:"getDmChatLog.do",
		data: {"user_id":sendId, "dm_id":dm_id, "dm_key":dm_key},
		success : function(data){
			
			if(data.check==true){
				var chatList = data.chatList;
				
				for(var i =0;i<chatList.length;i++){
					// 상대방이 보낸 message
					if(chatList[i].send_id!=sendId){
						var str = '<div class="anotherMsg">';
						str += '<span class="anotherName">';
						str += chatList[i].send_id;
						str += '</span>';
						str += '<span class="msg">';
						str += chatList[i].dm_content;
						str += '</span>';
						str += '</div>';
						$("#chatLog").append(str);						
					}else{
						// 내가 보낸 message
				        var str = '<div class="myMsg">';
				        str += '<span class="msg">';
				        str += chatList[i].dm_content;
				        str += '</span>';
				        str += '</div>';
				        $("#chatLog").append(str);		
						
					}
					
					
				}
				
			}
			
			
		},
		error:function(){
			alert("ajax : 통신 실패 ");
		}
    });
    
	
	 
}